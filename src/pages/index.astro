---
import Footer from '../components/layout/Footer.svelte';
import Header from '../components/layout/Header.svelte';
import Hero from '../components/sections/Hero.svelte';
import PathwaySelector from '../components/sections/PathwaySelector.svelte';
import StatsBar from '../components/sections/StatsBar.svelte';
import Testimonials from '../components/sections/Testimonials.svelte';
import BaseLayout from '../layouts/BaseLayout.astro';
import { sections } from '../lib/data/curriculum';
import type { Pathway } from '../lib/types/curriculum';

// Extract pathway sections and convert to Pathway objects
const pathwaySections = sections.filter((s) => s.id.startsWith('pathway-'));
const pathways: Pathway[] = pathwaySections.map((section) => ({
	id: section.id,
	title: section.title,
	description: section.description,
	videoCount: section.topics.reduce((count, topic) => count + (topic.videos?.length ?? 0), 0),
	topics: section.topics,
}));
---

<BaseLayout title="Engineering Education, Connected">
	<!-- Header Slot -->
	<Header slot="header" currentPath="/" client:load />

	<!-- Hero Section -->
	<section class="relative">
		<Hero client:visible />
		<div class="absolute inset-x-0 bottom-5 z-20">
			<StatsBar />
		</div>
	</section>

	<!-- Pathways Section -->
	<section class="section-shell bg-[var(--gradient-surface)]">
		<div class="content-shell">
			<div class="mx-auto mb-12 max-w-3xl text-center">
				<p class="text-xs font-semibold uppercase tracking-[0.2em] text-brand-cyan">Pathway Explorer</p>
				<h2 class="text-3xl tablet:text-4xl font-display font-bold text-brand-navy mb-4">
					Choose Your Pathway
				</h2>
				<p class="mx-auto max-w-2xl text-lg text-ink-700 font-sans">
					Select a specialist pathway to explore industry-connected curriculum content
				</p>
			</div>

			<PathwaySelector
				pathways={pathways}
				featuredPathway="pathway-2"
				client:visible
			/>
		</div>
	</section>

	<!-- Testimonials -->
	<Testimonials />

	<!-- Footer Slot -->
	<Footer slot="footer" />
</BaseLayout>
